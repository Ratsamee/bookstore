(window.webpackJsonpbookstore=window.webpackJsonpbookstore||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){"use strict";a.r(t);var n=a(27),l=a.n(n),r=a(0),c=a.n(r),o=a(26),s=a(21),i=a(25),u=a(6),m=a(7),d=a(9),h=a(8),p=a(11),b=a(10),v=a(105),E=a(106),f=a(107),g=a(112),S=a(108),k=a(15),y=a.n(k),I="https://bookstore-project3-server.herokuapp.com/api",O="https://www.googleapis.com/books/v1/volumes",C="USER_ID",_="CART",j=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).state={email:"",password:"",errorMessage:""},e._handleChange=e._handleChange.bind(Object(p.a)(e)),e._handleSubmit=e._handleSubmit.bind(Object(p.a)(e)),e}return Object(b.a)(t,e),Object(m.a)(t,[{key:"_handleChange",value:function(e){this.setState(Object(i.a)({},e.target.name,e.target.value))}},{key:"_handleSubmit",value:function(e){var t=this;e.preventDefault();var a={auth:{email:this.state.email,password:this.state.password}};y.a.post("".concat(I,"/user_token"),a).then(function(e){var t="Bearer "+e.data.jwt;return localStorage.setItem("JWT",t),y.a.get("".concat(I,"/users/current.json"),{headers:{Authorization:t}})}).then(function(e){localStorage.setItem(C,e.data.id),localStorage.setItem("FULL_NAME",e.data.full_name),t.props.history.push("/"),window.location.reload()}).catch(function(e){return t.setState({errorMessage:"Invaid email or password"})})}},{key:"render",value:function(){return c.a.createElement(v.a,null,c.a.createElement("div",{className:"sub_Container"},c.a.createElement("h1",null,"Sign in"),c.a.createElement("div",{className:"div-sign-in"},c.a.createElement(E.a,{className:"justify-content-md-center"},this.state.errorMessage?c.a.createElement(f.a,{variant:"danger"},this.state.errorMessage):""),c.a.createElement(g.a,{onSubmit:this._handleSubmit},c.a.createElement(g.a.Group,{controlId:"formBasicEmail"},c.a.createElement(g.a.Label,null,"Email address"),c.a.createElement(g.a.Control,{type:"email",placeholder:"Enter email",name:"email",onChange:this._handleChange,value:this.state.email,required:!0,maxLength:"25"})),c.a.createElement(g.a.Group,{controlId:"formBasicPassword"},c.a.createElement(g.a.Label,null,"Password"),c.a.createElement(g.a.Control,{type:"password",placeholder:"Password",name:"password",onChange:this._handleChange,value:this.state.password,required:!0,maxLength:"25"})),c.a.createElement(S.a,{variant:"success",type:"submit"},"Submit"))),c.a.createElement("hr",null),c.a.createElement("div",{className:"div-sign-up"},c.a.createElement(o.b,{to:"/signup"},"Sign Up"))))}}]),t}(r.Component),N=a(55),w=a(51),x=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e)))._addToCart=function(e){if(!localStorage.getItem(C))return alert("Please sign in/ sign up."),void a.props.history.push("/login");var t=[];localStorage.getItem(_)&&(t=JSON.parse(localStorage.getItem(_))),console.log("cart:",t),t.push(e),localStorage.setItem(_,JSON.stringify(t)),alert("Your book is on cart.")},a.state={data:[]},a.fetchData=a.fetchData.bind(Object(p.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"fetchData",value:function(e){var t=this,a="q=title:".concat(e);y.a.get("https://www.googleapis.com/books/v1/volumes",{params:{q:a.toLowerCase()}}).then(function(e){var a=e.data.items.filter(function(e){return"FOR_SALE"===e.saleInfo.saleability});t.setState({data:a})})}},{key:"render",value:function(){return c.a.createElement(v.a,null,c.a.createElement("div",{className:"sub_Container"},c.a.createElement("h1",null,"Search books"),c.a.createElement(P,{onSubmit:this.fetchData}),this.state.data?c.a.createElement(D,{info:this.state.data,onSubmit:this._addToCart}):""))}}]),t}(r.Component),L=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={book:e.data},a._handleSubmit=a._handleSubmit.bind(Object(p.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"_handleSubmit",value:function(e){e.preventDefault();var t=this.state.book.volumeInfo,a={id:w(),bookId:this.state.book.id,cover:t.imageLinks.smallThumbnail,title:t.title,price:this.state.book.saleInfo.retailPrice.amount,currency:this.state.book.saleInfo.retailPrice.currencyCode};this.props.onSubmit(a)}},{key:"render",value:function(){return c.a.createElement("form",{onSubmit:this._handleSubmit},c.a.createElement(S.a,{type:"submit",variant:"success"},"Add to Cart"))}}]),t}(r.Component),D=function(e){return c.a.createElement("div",{className:"content"},e.info.map(function(t,a){return c.a.createElement("div",{key:a,className:"div-card"},c.a.createElement("div",{className:"div-card-bg"},c.a.createElement("table",null,c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",null,c.a.createElement(o.b,{to:"/bookdetail/".concat(t.id)},c.a.createElement("img",{className:"img-cover",src:t.volumeInfo.imageLinks.smallThumbnail,alt:t.volumeInfo.title}))),c.a.createElement("td",null,t.volumeInfo.title)),c.a.createElement("tr",null,c.a.createElement("td",{className:"price"},c.a.createElement("p",null,"$",t.saleInfo.retailPrice.amount)),c.a.createElement("td",null,c.a.createElement(L,{data:t,onSubmit:e.onSubmit})))))))}))},P=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).state={query:""},e._handleInput=e._handleInput.bind(Object(p.a)(e)),e._handleSubmit=e._handleSubmit.bind(Object(p.a)(e)),e}return Object(b.a)(t,e),Object(m.a)(t,[{key:"_handleInput",value:function(e){this.setState({query:e.target.value})}},{key:"_handleSubmit",value:function(e){e.preventDefault(),this.props.onSubmit(this.state.query)}},{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("form",{onSubmit:this._handleSubmit},c.a.createElement("table",{className:"search-center"},c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",{className:"search-center-text"}," ",c.a.createElement(N.a,{type:"text",placeholder:"please type title or author",className:"mr-sm-2 ",onChange:this._handleInput,autoFocus:!0})," "),c.a.createElement("td",null,c.a.createElement(S.a,{type:"submit",variant:"success"},"Search")))))))}}]),t}(r.Component),A=a(109),q=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).state={books:[]},e._removeItem=e._removeItem.bind(Object(p.a)(e)),e._handleSubmit=e._handleSubmit.bind(Object(p.a)(e)),e}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem(_)&&this.setState({books:JSON.parse(localStorage.getItem(_))})}},{key:"_removeItem",value:function(e){var t=e.target.id,a=this.state.books;a&&(a=a.filter(function(e){return e.id!==t}),this.setState({books:a})),0===a.length?localStorage.setItem(_,""):localStorage.setItem(_,JSON.stringify(a))}},{key:"_handleSubmit",value:function(e){e.preventDefault(),this.props.history.push("/checkout")}},{key:"render",value:function(){return c.a.createElement(v.a,null,c.a.createElement("div",{className:"sub_Container"},c.a.createElement("h1",null,"Your cart list"),c.a.createElement("form",{onSubmit:this._handleSubmit},c.a.createElement(A.a,null,c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Image"),c.a.createElement("th",null,"Title"),c.a.createElement("th",null,"Price"),c.a.createElement("th",null))),c.a.createElement(F,{data:this.state.books,onClick:this._removeItem})),c.a.createElement("div",null,0===this.state.books.length?"":c.a.createElement(S.a,{type:"submit",variant:"success",size:"lg",block:!0},"Check Out")))))}}]),t}(r.Component),F=function(e){return e.data.length>0?c.a.createElement("tbody",null,e.data.map(function(t,a){return c.a.createElement("tr",{key:a},c.a.createElement("td",null,c.a.createElement("img",{width:"80px;",src:t.cover,alt:t.title})),c.a.createElement("td",null,c.a.createElement("span",null,t.title)),c.a.createElement("td",null,c.a.createElement("span",null,"".concat(t.price," ").concat(t.currency))),c.a.createElement("td",null,c.a.createElement(S.a,{id:t.id,variant:"danger",onClick:e.onClick},"Delete")))})):c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("td",{className:"noItem",colSpan:"4"},"No Items...")))},T=a(61),B=a(58),J=a(19),M=a.n(J);function G(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/\D+/g,"")}a(91),a(92);var U=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(l)))).state={number:"",name:"",expiry:"",cvc:"",issuer:"",focused:"",formData:null},a.handleCallback=function(e,t){var n=e.issuer;t&&a.setState({issuer:n})},a.handleInputFocus=function(e){var t=e.target;a.setState({focused:t.name})},a.handleInputChange=function(e){var t=e.target;"number"===t.name?t.value=function(e){if(!e)return e;var t,a=M.a.fns.cardType(e),n=G(e);switch(a){case"amex":t="".concat(n.slice(0,4)," ").concat(n.slice(4,10)," ").concat(n.slice(10,15));break;case"dinersclub":t="".concat(n.slice(0,4)," ").concat(n.slice(4,10)," ").concat(n.slice(10,14));break;default:t="".concat(n.slice(0,4)," ").concat(n.slice(4,8)," ").concat(n.slice(8,12)," ").concat(n.slice(12,19))}return t.trim()}(t.value):"expiry"===t.name?t.value=function(e){var t=G(e);return t.length>=3?"".concat(t.slice(0,2),"/").concat(t.slice(2,4)):t}(t.value):"cvc"===t.name&&(t.value=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=G(e),l=4;return a.number&&(l="amex"===M.a.fns.cardType(a.number)?4:3),n.slice(0,l)}(t.value)),a.setState(Object(i.a)({},t.name,t.value))},a.handleSubmit=function(e){e.preventDefault();var t=Object(T.a)(e.target.elements).filter(function(e){return e.name}).reduce(function(e,t){return e[t.name]=t.value,e},{});a.setState({formData:t}),a.form.reset()},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.number,l=t.expiry,r=t.cvc,o=t.focused;return c.a.createElement("div",{key:"Payment"},c.a.createElement("div",{className:"App-payment"},c.a.createElement("h1",null,"Payment Credit Cards"),c.a.createElement(B.a,{number:n,name:a,expiry:l,cvc:r,focused:o,callback:this.handleCallback}),c.a.createElement("form",{ref:function(t){return e.form=t},onSubmit:this.handleSubmit},c.a.createElement("div",{className:"form-group"},c.a.createElement("input",{type:"tel",name:"number",className:"form-control",placeholder:"Card Number",pattern:"[\\d| ]{16,22}",required:!0,onChange:this.handleInputChange,onFocus:this.handleInputFocus})),c.a.createElement("div",{className:"form-group"},c.a.createElement("input",{type:"text",name:"name",className:"form-control",placeholder:"Name",required:!0,onChange:this.handleInputChange,onFocus:this.handleInputFocus})),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-6"},c.a.createElement("input",{type:"tel",name:"expiry",className:"form-control",placeholder:"Valid Thru",pattern:"\\d\\d/\\d\\d",required:!0,onChange:this.handleInputChange,onFocus:this.handleInputFocus})),c.a.createElement("div",{className:"col-6"},c.a.createElement("input",{type:"tel",name:"cvc",className:"form-control",placeholder:"CVC",pattern:"\\d{3,4}",required:!0,onChange:this.handleInputChange,onFocus:this.handleInputFocus}))))))}}]),t}(c.a.Component),W=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(d.a)(this,Object(h.a)(t).call(this))).state={books:[],order_id:0},e._handleSubmit=e._handleSubmit.bind(Object(p.a)(e)),e}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem(_)&&this.setState({books:JSON.parse(localStorage.getItem(_))})}},{key:"_handleSubmit",value:function(){var e=this,t={user_id:Number(localStorage.getItem(C)),order_date:(new Date).toISOString().slice(0,10)},a={headers:{Authorization:localStorage.getItem("JWT")}};y.a.post("".concat(I,"/orders.json"),t,a).then(function(t){var n=t.data;e.setState({order_id:n.id}),e.state.books.forEach(function(e){var t={order_id:n.id,book_id:e.bookId,price:e.price,cover_image:e.cover};y.a.post("".concat(I,"/order_details.json"),t,a)})}).then(function(){localStorage.removeItem(_),alert("done, order id: ".concat(e.state.order_id)),e.props.history.push("/")}).catch(function(e){return console.error(e)})}},{key:"render",value:function(){return c.a.createElement(v.a,null,c.a.createElement("div",{className:"sub_Container"},c.a.createElement("h1",null,"CheckOut"),c.a.createElement(A.a,null,c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Book Title"),c.a.createElement("th",null,"Price"))),c.a.createElement("tbody",null,this.state.books.map(function(e,t){return c.a.createElement("tr",{key:t},c.a.createElement("td",null,c.a.createElement("span",null,e.title)),c.a.createElement("td",null,c.a.createElement("span",null,"$"+e.price)))})),c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("td",{className:"price"},"Total"),c.a.createElement("td",{className:"price"},"$"+this.state.books.map(function(e){return e.price}).reduce(function(e,t){return e+t},0).toFixed(2))))),c.a.createElement(U,null),c.a.createElement(S.a,{onClick:this._handleSubmit,variant:"success",size:"lg",block:!0},"Checkout")))}}]),t}(r.Component),z=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){localStorage.removeItem(C),localStorage.removeItem("FULL_NAME"),localStorage.removeItem(_),this.props.history.push("/"),window.location.reload()}},{key:"render",value:function(){return c.a.createElement("div",null)}}]),t}(r.Component),$=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={full_name:"",address:"",shipping_address:"",email:"",password:""},a._handleChange=a._handleChange.bind(Object(p.a)(a)),a._handleSubmit=a._handleSubmit.bind(Object(p.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"_handleChange",value:function(e){this.setState(Object(i.a)({},e.target.name,e.target.value))}},{key:"_handleSubmit",value:function(e){var t=this;e.preventDefault(),y.a.post("".concat(I,"/users.json"),this.state).then(function(e){localStorage.setItem("FULL_NAME",e.data.full_name),localStorage.setItem(C,e.data.user_id);var a={auth:{email:t.state.email,password:t.state.password}};return y.a.post("".concat(I,"/user_token"),a)}).then(function(e){var a="Bearer "+e.data.jwt;localStorage.setItem("JWT",a),t.props.history.push("/"),window.location.reload()}).catch(function(e){return console.error("Throw ex:",e)})}},{key:"render",value:function(){return c.a.createElement(v.a,null,c.a.createElement("div",{className:"sub_Container"},c.a.createElement("h1",null,"Sign Up"),c.a.createElement("div",{className:"div-sign-in"},c.a.createElement(g.a,{onSubmit:this._handleSubmit},c.a.createElement(g.a.Group,{controlId:"formName"},c.a.createElement(g.a.Label,null,"Full Name"),c.a.createElement(g.a.Control,{type:"text",placeholder:"Enter full name",name:"full_name",onChange:this._handleChange,value:this.state.full_name,required:!0,maxLength:"40"})),c.a.createElement(g.a.Group,{controlId:"formAddress"},c.a.createElement(g.a.Label,null,"Address"),c.a.createElement(g.a.Control,{type:"text",placeholder:"Address",name:"address",onChange:this._handleChange,value:this.state.address,required:!0,maxLength:"200"})),c.a.createElement(g.a.Group,{controlId:"formShippingAddress"},c.a.createElement(g.a.Label,null,"Shipping Address"),c.a.createElement(g.a.Control,{type:"text",placeholder:"Shipping Address",name:"shipping_address",onChange:this._handleChange,value:this.state.shipping_address,required:!0,maxLength:"200"})),c.a.createElement(g.a.Group,{controlId:"formBasicEmail"},c.a.createElement(g.a.Label,null,"Email address"),c.a.createElement(g.a.Control,{type:"email",placeholder:"Enter email",name:"email",onChange:this._handleChange,value:this.state.email,required:!0,maxLength:"25"})),c.a.createElement(g.a.Group,{controlId:"formBasicPassword"},c.a.createElement(g.a.Label,null,"Password"),c.a.createElement(g.a.Control,{type:"password",placeholder:"Password",name:"password",onChange:this._handleChange,value:this.state.password,required:!0,maxLength:"25"})),c.a.createElement(S.a,{variant:"success",type:"submit"},"Submit")))))}}]),t}(r.Component),R=a(51),Y=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={id:{},volumn:{},authors:[],imageLink:{},saleInfo:{}},a._handleOnClick=a._handleOnClick.bind(Object(p.a)(a)),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=O+"/"+this.props.match.params.id;y.a.get(t).then(function(t){var a=t.data;e.setState({id:e.props.match.params.id}),e.setState({volumn:a.volumeInfo}),e.setState({authors:a.volumeInfo.authors}),e.setState({imageLink:a.volumeInfo.imageLinks}),e.setState({saleInfo:a.saleInfo.retailPrice})})}},{key:"_handleOnClick",value:function(){if(!localStorage.getItem(C))return alert("Please sign in/ sign up."),void this.props.history.push("/login");var e=this.state.volumn,t={id:R(),bookId:this.state.id,cover:e.imageLinks.smallThumbnail,title:e.title,price:this.state.saleInfo.amount,currency:this.state.saleInfo.currencyCode},a=[];localStorage.getItem(_)&&(a=JSON.parse(localStorage.getItem(_))),a.push(t),localStorage.setItem(_,JSON.stringify(a)),alert("Your book is on cart.")}},{key:"render",value:function(){return c.a.createElement(v.a,null,c.a.createElement("div",{className:"sub_Container"},c.a.createElement("h1",null,this.state.volumn.title),c.a.createElement("h2",null,this.state.volumn.subtitle),c.a.createElement("div",{className:"grid"},c.a.createElement("div",null,c.a.createElement("p",null," ",c.a.createElement("span",{className:"noItem"},"Author: "),"  ",this.state.authors.join(", ")),c.a.createElement("p",null," ",c.a.createElement("span",{className:"noItem"},"Publisher: ")," ",this.state.volumn.publisher),c.a.createElement("p",null,c.a.createElement("span",{className:"noItem"},"Publish date: "),this.state.volumn.publishedDate),c.a.createElement("p",null,c.a.createElement("span",{className:"noItem"},"Description:")," "),c.a.createElement("p",null,this.state.volumn.description),c.a.createElement("div",{className:"div-inline-block"},c.a.createElement(S.a,{variant:"success",onClick:this._handleOnClick},"Add to Cart"))),c.a.createElement("div",{className:"div-inline-block"},c.a.createElement("img",{src:this.state.imageLink.small,alt:this.state.volumn.title}),c.a.createElement("div",{className:"price"},"Price:\xa0","".concat(this.state.saleInfo.amount,"\xa0").concat(this.state.saleInfo.currencyCode))))))}}]),t}(r.Component),V=a(110),H=a(111),K=(a(93),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return c.a.createElement(V.a,{bg:"light",expand:"lg"},localStorage.getItem(C)?"":c.a.createElement(V.a.Brand,{href:"#login"},"Sign In"),c.a.createElement(V.a.Brand,{href:"#"},"Home"),c.a.createElement(H.a,{className:"mr-auto"}),localStorage.getItem(C)?c.a.createElement(V.a.Brand,{href:"#cart"},"Cart"):"",localStorage.getItem(C)?c.a.createElement(V.a.Brand,{href:"#logout"},"Sign Out"):"")}}]),t}(r.Component)),Q=c.a.createElement(o.a,null,c.a.createElement("div",null,c.a.createElement(K,null),c.a.createElement(s.a,{exact:!0,path:"/",component:x}),c.a.createElement(s.a,{exact:!0,path:"/login",component:j}),c.a.createElement(s.a,{exact:!0,path:"/checkout",component:W}),c.a.createElement(s.a,{exact:!0,path:"/cart",component:q}),c.a.createElement(s.a,{exact:!0,path:"/logout",component:z}),c.a.createElement(s.a,{exact:!0,path:"/signup",component:$}),c.a.createElement(s.a,{exact:!0,path:"/bookdetail/:id",component:Y})));a(102),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(Q,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},62:function(e,t,a){e.exports=a(103)},91:function(e,t,a){}},[[62,1,2]]]);
//# sourceMappingURL=main.9afbd6ee.chunk.js.map